<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <imports>
        <import resource="service/course.xml"/>
        <import resource="service/user.xml"/>
    </imports>

    <parameters>
        <!--TAGS-->
        <parameter key="simple_it.claire.associated_content.repository.tag_by_part.class">SimpleIT\ClaireAppBundle\Repository\AssociatedContent\TagByPartRepository</parameter>
        <parameter key="simple_it.claire.associated_content.tag.class">SimpleIT\ClaireAppBundle\Services\AssociatedContent\TagService</parameter>


        <parameter key="simple_it.claire_api.class">SimpleIT\ClaireAppBundle\Api\ClaireApi</parameter>

        <parameter key="simple_it.claire_categories_api.class">SimpleIT\ClaireAppBundle\Api\CategoryRouteService</parameter>
        <parameter key="simple_it.claire.http.transport.class">SimpleIT\AppBundle\Services\HttpTransport</parameter>
        <parameter key="simple_it.claire.category.class">SimpleIT\ClaireAppBundle\Services\CategoryService</parameter>
        <parameter key="simple_it.claire.tag.class">SimpleIT\ClaireAppBundle\Services\TagService</parameter>

        <parameter key="simple_it.claire.associated_course.class">SimpleIT\ClaireAppBundle\Services\CourseAssociation\AssociatedCourseService</parameter>
        <parameter key="simple_it.claire.twig.metadata.class">SimpleIT\ClaireAppBundle\Twig\MetadataExtension</parameter>

        <parameter key="simple_it.claire.buzz.client.class">SimpleIT\AppBundle\Buzz\Client\MultiCurl</parameter>
        <parameter key="buzz.browser.class">Buzz\Browser</parameter>

        <!-- REPOSITORIES CLASS -->
        <parameter key="simple_it.claire.repository.category.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\CategoryRepository</parameter>
        <parameter key="simple_it.claire.repository.tag.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\TagRepository</parameter>
        <parameter key="simple_it.claire.repository.associated_course.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\AssociatedCourseRepository</parameter>
    </parameters>

    <services>

        <service id="simple_it.claire.http_client"
                 class="%simple_it.app_bundle.http_client.class%"
                 factory-service="simple_it.app_bundle.client_factory"
                 factory-method="get">
            <argument>%simple_it_claire_app%</argument>
        </service>

        <!--USER-->


        <!--ASSOCIATED CONTENT-->
        <service id="simple_it.claire.associated_content.repository.tag_by_part" class="%simple_it.claire.associated_content.repository.tag_by_part.class%" >
            <call method="setClient">
                <argument type="service" id="simple_it.claire.http_client" />
            </call>
            <call method="setSerializer">
                <argument type="service" id="serializer" />
            </call>
        </service>

        <service id="simple_it.claire.associated_content.tag" class="%simple_it.claire.associated_content.tag.class%" >
            <call method="setTagByPartRepository">
                <argument type="service" id="simple_it.claire.associated_content.repository.tag_by_part" />
            </call>
        </service>

        <!--OLD SHIT-->

        <service id="simple_it.claire.buzz.client" class="%simple_it.claire.buzz.client.class%" public="false" />

        <service id="simple_it.claire.buzz" class="%buzz.browser.class%">
            <argument type="service" id="simple_it.claire.buzz.client" />
            <argument type="service" id="buzz.message_factory" />
        </service>

        <service id="simple_it.claire.http.transport"
                 parent="simple_it.claire.buzz"
                 class="%simple_it.claire.http.transport.class%">
            <call method="setHost">
                <argument>%simple_it_claire_app.host%</argument>
            </call>
        </service>


        <service id="claire_api_service" class="%simple_it.claire_api.class%" parent="api">
            <call method="setTransportService">
                <argument type="service" id="simple_it.claire.http.transport" />
            </call>
        </service>

        <service id="claire_categories_api" class="%simple_it.claire_categories_api.class%" />

        <!-- AssociatedCourseService -->
        <service id="simpleit.claire.associated_course" class="%simple_it.claire.associated_course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setAssociatedCourseRepository">
                <argument type="service" id="simple_it.claire.repository.associated_course" />
            </call>
        </service>

        <service id="simpleit.claire.category" class="%simple_it.claire.category.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setCategoryRepository">
                <argument type="service" id="simple_it.claire.repository.category" />
            </call>
        </service>

        <service id="simpleit.claire.tag" class="%simple_it.claire.tag.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setTagRepository">
                <argument type="service" id="simple_it.claire.repository.tag" />
            </call>
            <call method="setCategoryRepository">
                <argument type="service" id="simple_it.claire.repository.category" />
            </call>
        </service>

        <service id="simple_it.claire.twig.metadata" class="%simple_it.claire.twig.metadata.class%" >
            <tag name="twig.extension" />
        </service>

        <!-- REPOSITORIES -->
        <service id="simple_it.claire.repository.category" class="%simple_it.claire.repository.category.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <service id="simple_it.claire.repository.tag" class="%simple_it.claire.repository.tag.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <!-- AssociatedCourseService -->
        <service id="simple_it.claire.repository.associated_course" class="%simple_it.claire.repository.associated_course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
    </services>

</container>
