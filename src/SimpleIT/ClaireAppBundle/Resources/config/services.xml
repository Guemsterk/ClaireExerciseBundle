<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">


    <parameters>
        <parameter key="simple_it.claire.course.repository.part.class">SimpleIT\ClaireAppBundle\Repository\Course\PartRepository</parameter>
        <parameter key="simple_it.claire.course.repository.part_content.class">SimpleIT\ClaireAppBundle\Repository\Course\PartContentRepository</parameter>
        <parameter key="simple_it.claire.course.repository.metadata_by_part.class">SimpleIT\ClaireAppBundle\Repository\Course\MetadataByPartRepository</parameter>

        <parameter key="simple_it.claire.course.class">SimpleIT\ClaireAppBundle\Services\CourseService</parameter>
        <parameter key="simple_it.claire.course.part.class">SimpleIT\ClaireAppBundle\Services\Course\PartService</parameter>
        <parameter key="simple_it.claire.course.metadata.class">SimpleIT\ClaireAppBundle\Services\Course\MetadataService</parameter>


        <parameter key="simple_it.claire_api.class">SimpleIT\ClaireAppBundle\Api\ClaireApi</parameter>

        <parameter key="simple_it.claire_categories_api.class">SimpleIT\ClaireAppBundle\Api\CategoryRouteService</parameter>
        <parameter key="simple_it.claire.http.transport.class">SimpleIT\AppBundle\Services\HttpTransport</parameter>
        <parameter key="simple_it.claire.category.class">SimpleIT\ClaireAppBundle\Services\CategoryService</parameter>
        <parameter key="simple_it.claire.tag.class">SimpleIT\ClaireAppBundle\Services\TagService</parameter>
        <parameter key="simple_it.claire.author.class">SimpleIT\ClaireAppBundle\Services\Profile\AuthorService</parameter>
        <parameter key="simple_it.claire.associated_course.class">SimpleIT\ClaireAppBundle\Services\CourseAssociation\AssociatedCourseService</parameter>
        <parameter key="simple_it.claire.twig.metadata.class">SimpleIT\ClaireAppBundle\Twig\MetadataExtension</parameter>

        <parameter key="simple_it.claire.buzz.client.class">SimpleIT\AppBundle\Buzz\Client\MultiCurl</parameter>
        <parameter key="buzz.browser.class">Buzz\Browser</parameter>

        <!-- REPOSITORIES CLASS -->
        <parameter key="simple_it.claire.repository.course.class">SimpleIT\ClaireAppBundle\Repository\Course\CourseRepository</parameter>
        <parameter key="simple_it.claire.repository.part.class">SimpleIT\ClaireAppBundle\Repository\Course\PartRepository</parameter>
        <parameter key="simple_it.claire.repository.category.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\CategoryRepository</parameter>
        <parameter key="simple_it.claire.repository.tag.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\TagRepository</parameter>
        <parameter key="simple_it.claire.repository.author.class">SimpleIT\ClaireAppBundle\Repository\User\AuthorRepository</parameter>
        <parameter key="simple_it.claire.repository.associated_course.class">SimpleIT\ClaireAppBundle\Repository\CourseAssociation\AssociatedCourseRepository</parameter>
    </parameters>

    <services>

        <service id="simple_it.claire.http_client"
                 class="%simple_it.app_bundle.http_client.class%"
                 factory-service="simple_it.app_bundle.client_factory"
                 factory-method="get">
            <argument>%simple_it_claire_app%</argument>
        </service>

        <!--COURSE-->
        <service id="simple_it.claire.course.repository.part_content" class="%simple_it.claire.course.repository.part_content.class%" >
            <call method="setClient">
                <argument type="service" id="simple_it.claire.http_client" />
            </call>
            <call method="setSerializer">
                <argument type="service" id="serializer" />
            </call>
        </service>

        <service id="simple_it.claire.course.repository.part" class="%simple_it.claire.course.repository.part.class%" >
            <call method="setClient">
                <argument type="service" id="simple_it.claire.http_client" />
            </call>
            <call method="setSerializer">
                <argument type="service" id="serializer" />
            </call>
        </service>

        <service id="simple_it.claire.course.repository.metadata_by_part" class="%simple_it.claire.course.repository.metadata_by_part.class%" >
            <call method="setClient">
                <argument type="service" id="simple_it.claire.http_client" />
            </call>
            <call method="setSerializer">
                <argument type="service" id="serializer" />
            </call>
        </service>

        <service id="simple_it.claire.course.part" class="%simple_it.claire.course.part.class%" >
            <call method="setPartContentRepository">
                <argument type="service" id="simple_it.claire.course.repository.part_content" />
            </call>
            <call method="setPartRepository">
                <argument type="service" id="simple_it.claire.course.repository.part" />
            </call>
        </service>

        <service id="simple_it.claire.course.metadata" class="%simple_it.claire.course.metadata.class%" >
            <call method="setMetadataByPartRepository">
                <argument type="service" id="simple_it.claire.course.repository.metadata_by_part" />
            </call>
        </service>


        <!--OLD SHIT-->

        <service id="simple_it.claire.buzz.client" class="%simple_it.claire.buzz.client.class%" public="false" />

        <service id="simple_it.claire.buzz" class="%buzz.browser.class%">
            <argument type="service" id="simple_it.claire.buzz.client" />
            <argument type="service" id="buzz.message_factory" />
        </service>

        <service id="simple_it.claire.http.transport"
                 parent="simple_it.claire.buzz"
                 class="%simple_it.claire.http.transport.class%">
            <call method="setHost">
                <argument>%simple_it_claire_app.host%</argument>
            </call>
        </service>


        <service id="claire_api_service" class="%simple_it.claire_api.class%" parent="api">
            <call method="setTransportService">
                <argument type="service" id="simple_it.claire.http.transport" />
            </call>
        </service>

        <service id="claire_categories_api" class="%simple_it.claire_categories_api.class%" />

        <service id="simpleit.claire.course" class="%simple_it.claire.course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setCourseRepository">
                <argument type="service" id="simple_it.claire.repository.course" />
            </call>
            <call method="setPartRepository">
                <argument type="service" id="simple_it.claire.repository.part" />
            </call>
            <call method="setCategoryRepository">
                <argument type="service" id="simple_it.claire.repository.category" />
            </call>
        </service>



        <!-- AssociatedCourseService -->
        <service id="simpleit.claire.associated_course" class="%simple_it.claire.associated_course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setAssociatedCourseRepository">
                <argument type="service" id="simple_it.claire.repository.associated_course" />
            </call>
        </service>

        <service id="simpleit.claire.category" class="%simple_it.claire.category.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setCategoryRepository">
                <argument type="service" id="simple_it.claire.repository.category" />
            </call>
        </service>

        <service id="simpleit.claire.tag" class="%simple_it.claire.tag.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setTagRepository">
                <argument type="service" id="simple_it.claire.repository.tag" />
            </call>
            <call method="setCategoryRepository">
                <argument type="service" id="simple_it.claire.repository.category" />
            </call>
        </service>

        <service id="simpleit.claire.author" class="%simple_it.claire.author.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
            <call method="setAuthorRepository">
                <argument type="service" id="simple_it.claire.repository.author" />
            </call>
        </service>

        <service id="simple_it.claire.twig.metadata" class="%simple_it.claire.twig.metadata.class%" >
            <tag name="twig.extension" />
        </service>

        <!-- REPOSITORIES -->
        <service id="simple_it.claire.repository.course" class="%simple_it.claire.repository.course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <service id="simple_it.claire.repository.part" class="%simple_it.claire.repository.part.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>

        <service id="simple_it.claire.repository.category" class="%simple_it.claire.repository.category.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <service id="simple_it.claire.repository.tag" class="%simple_it.claire.repository.tag.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <service id="simple_it.claire.repository.author" class="%simple_it.claire.repository.author.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
        <!-- AssociatedCourseService -->
        <service id="simple_it.claire.repository.associated_course" class="%simple_it.claire.repository.associated_course.class%" >
            <call method="setClaireApi">
                <argument type="service" id="claire_api_service" />
            </call>
        </service>
    </services>

</container>
