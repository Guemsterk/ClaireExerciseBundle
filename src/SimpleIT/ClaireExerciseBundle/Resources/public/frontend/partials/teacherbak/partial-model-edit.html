<div data-ng-controller="modelController">
<div class="row" data-ng-controller="modelEditController">

<div class="col-xs-12">
    <div class="panel-body">
        <div class="panel panel-primary" style="margin-bottom: 0">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-centered" ng-switch="model.type">
                        <div ng-switch-when="multiple-choice">
                            <span title="QCM" class="glyphicon glyphicon-check" style="font-size:500%"></span>
                        </div>
                        <div ng-switch-when="open-ended-question">
                                    <span class="glyphicon glyphicon-question-sign" style="font-size: 500%"
                                          title="Question à réponse courte ouverte"></span>
                        </div>
                        <div ng-switch-when="pair-items">
                            <span title="Exercice d'appariement" class="glyphicon glyphicon-random" style="font-size: 500%"></span>
                        </div>
                        <div ng-switch-when="order-items">
                            <span title="Exercice d'ordonnancement" class="glyphicon glyphicon-sort" style="font-size: 500%"></span>
                        </div>
                        <div ng-switch-when="group-items">
                            <span title="Exercice de groupement" class="glyphicon glyphicon-link" style="font-size: 500%"></span>
                        </div>
                    </div>
                    <div class="col-xs-4 col-centered">
                        <h4>Titre</h4>
                        <input type="text" ng-model="model.title" class="form-control"
                            title="Permet de retrouver le modèle dans les listes"/>
                    </div>
                    <div class="col-centered">
                        <!--<h4>Auteur</h4>-->
                        <!--<input type="text" ng-model="users[model.author]" class="form-control" disabled>-->
                        <h4>Propriétaire</h4>
                        <input type="text" ng-model="users[model.owner]" class="form-control" disabled>
                    </div>
                    <div class="col-xs-2 col-centered">
                        <div title="Ce modèle est-il partagé avec les autres auteurs ?">
                            <div class="col-centered">
                                <span class="glyphicon" ng-class="{'glyphicon-check': model.public, 'glyphicon-unchecked': !model.public}" data-ng-click="model.public=!model.public"></span>
                            </div>
                            <div class="col-centered">
                                <h4>Partagé</h4>
                            </div>
                        </div>
                        <!--<div>-->
                        <!--<div class="col-centered">-->
                        <!--<span class="glyphicon" ng-class="{'glyphicon-check': model.archived, 'glyphicon-unchecked': !model.archived}" data-ng-click="model.archived=!model.archived"></span>-->
                        <!--</div>-->
                        <!--<div class="col-centered">-->
                        <!--<h4>Archivé</h4>-->
                        <!--</div>-->
                        <!--</div>-->
                        <!--<div>-->
                        <!--<div class="col-centered">-->
                        <!--<span class="glyphicon" ng-class="{'glyphicon-check': model.draft, 'glyphicon-unchecked': !model.draft}" data-ng-click="model.draft=!model.draft"></span>-->
                        <!--</div>-->
                        <!--<div class="col-centered">-->
                        <!--<h4>Brouillon</h4>-->
                        <!--</div>-->
                        <!--</div>-->
                        <div title="Ce modèle est-il valide pour générer des exercices ?">
                            <div class="col-centered">
                                <span class="glyphicon" ng-class="{'glyphicon-check': model.complete, 'glyphicon-unchecked': !model.complete}"></span>
                            </div>
                            <div class="col-centered">
                                <h4>Complet</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div
    ng-class="{'col-xs-5': !$parent.toggleResourceList, 'col-xs-12': $parent.toggleResourceList}">
<div class="panel-body">

<accordion
    title="Documents annexes à présenter à l'apprenant après la consigne lors de la résolution d'un exercice. Il peut s'agir de texte ou d'image. Ajouter-les en les glissant depuis la liste des ressource.">
    <accordion-group class="panel panel-primary">
        <accordion-heading class="panel-heading">
            <div class="row">
                <div class="col-xs-11" data-ng-click="">
                    Documents&nbsp;<span class="caret"></span>
                </div>
                <div class="col-xs-1">
                    <span data-ng-click="" class="glyphicon glyphicon-plus"></span>
                </div>
            </div>
        </accordion-heading>
        <div class="panel-body panel panel-primary" collapse="context.pair_items.pair_blocks.resources.collapse" ui-on-Drop="onDropDocument($event,$data,model.content.documents)">
            <accordion close-others="true">
                <accordion-group class="panel panel-success" data-ng-repeat="documentId in model.content.documents track by $index" class="row" data-ng-init="getDocumentInfo(documentId.id)">
                    <accordion-heading class="panel-heading">
                        <div class="row">
                            <div class="col-xs-2" ng-switch="usedDocuments[documentId.id].type">
                                <div ng-switch-when="text">
                                    <span title="Texte" class="glyphicon glyphicon-font" style="font-size: 260%"></span>
                                </div>
                                <div ng-switch-when="picture">
                                    <img title="Image" ng-src="{{BASE_CONFIG.urls.images.uploads}}{{usedDocuments[documentId.id].content.source}}" style="width: 40px; height: 40px;"/>
                                </div>
                                <div ng-switch-when="multiple-choice-question">
                                    <span title="QCM" class="glyphicon glyphicon-check" style="font-size: 260%"></span>
                                </div>
                                <div ng-switch-when="open-ended-question">
                                                <span class="glyphicon glyphicon-question-sign" title="Question à réponse courte ouverte"
                                                      style="font-size: 260%"></span>
                                </div>
                                <div ng-switch-when="sequence">
                                    <span class="glyphicon glyphicon-sort-by-order" style="font-size: 260%"></span>
                                </div>
                            </div>
                            <div class="col-xs-8">
                                <h4>{{ usedDocuments[documentId.id].title }}&nbsp;<span class="caret"></span>
                                </h4>
                            </div>
                            <div class="col-xs-1">

                            </div>
                            <div class="col-xs-1">
                                            <span data-ng-click="$event.stopPropagation();modelRemoveField(model.content.documents, $index)"
                                                  class="glyphicon glyphicon-remove"></span>
                            </div>
                        </div>
                    </accordion-heading>
                    <div class="row">
                        <div class="col-xs-12">
                            <small>ID: {{ usedDocuments[documentId.id].id }}</small>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-4">
                            <small>Auteur: {{ users[usedDocuments[documentId.id].author] }}</small>
                            <br>
                            <small>Propriétaire: {{ users[usedDocuments[documentId.id].owner] }}</small>
                        </div>
                        <div class="col-xs-4">
                            <small>Partagé:&nbsp;
                                <ng-switch on="usedDocuments[documentId.id].public">
                                    <span ng-switch-when="true">Oui</span>
                                    <span ng-switch-when="false">Non</span>
                                </ng-switch>
                            </small>
                            <br>
                            <small>Archivé:&nbsp;
                                <ng-switch on="usedDocuments[documentId.id].archived">
                                    <span ng-switch-when="true">Oui</span>
                                    <span ng-switch-when="false">Non</span>
                                </ng-switch>
                            </small>
                        </div>
                        <div class="col-xs-4">
                            <small>Brouillon:&nbsp;
                                <ng-switch on="usedDocuments[documentId.id].draft">
                                    <span ng-switch-when="true">Oui</span>
                                    <span ng-switch-when="false">Non</span>
                                </ng-switch>
                            </small>
                            <br>
                            <small>Complet:&nbsp;
                                <ng-switch on="usedDocuments[documentId.id].complete">
                                    <span ng-switch-when="true">Oui</span>
                                    <span ng-switch-when="false">Non</span>
                                </ng-switch>
                            </small>
                        </div>
                    </div>
                </accordion-group>
            </accordion>
        </div>
    </accordion-group>
</accordion>

<accordion>
    <accordion-group class="panel panel-primary" is-open="true">
        <accordion-heading class="panel-heading">
            <div class="row">
                <div class="col-xs-12">
                    Consigne&nbsp;<span class="caret"></span>
                </div>
            </div>
        </accordion-heading>
        <textarea class="form-control" rows="5" placeholder="Consigne de l'exercice" ng-model="model.content.wording"></textarea>
    </accordion-group>
</accordion>

<div ng-switch="model.type">
<div ng-switch-when="pair-items">
<accordion> <!-- close-others="true" -->
<accordion-group class="panel panel-primary" name="accordionBlock" data-ng-repeat="pair_blocks in model.content.pair_blocks track by $index" ng-init="openFirst('accordionBlock', $index)" is-open="openFirstBlocks.accordionBlock[$index]">
<accordion-heading class="panel-heading">
    <div class="row" data-ng-init="usedResources.push([])"
         title="Un bloc désigne un ensemble de ressources dont une partie sera tirée aléatoirement lors de la génération d'exercices">
        <div class="col-xs-11">
            Bloc d'appariement&nbsp;<span class="caret"></span>
        </div>
        <div class="col-xs-1">
            <span data-ng-click="$event.stopPropagation();modelRemoveField(model.content.pair_blocks, $index)" class="glyphicon glyphicon-remove"></span>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-6"
             title="La clé de métadonnée utilisée pour constituer la partie mobile des paires">
            <h5>Clé de métadonnée</h5>
            <input ng-click="$event.stopPropagation();"
                   type="text" ng-model="pair_blocks.pair_meta_key"
                   class="form-control" ui-on-Drop="onDropMetadataKey($event,$data,pair_blocks,'pair_meta_key')"/>
        </div>
        <div class="col-xs-6"
             title="Le nombre de ressources à utiliser parmi celles de ce bloc pour constituer des paires lors de la génération de l'exercice">
            <h5>Nombre de paires</h5>
            <input type="text" ng-click="$event.stopPropagation();"
                   ng-model="pair_blocks.number_of_occurrences" class="form-control"/>
        </div>
    </div>
</accordion-heading>

<tabset>
<tab>
    <tab-heading
        title="Lister explicitement les ressources. Pensez à cocher la case si c'est le choix que vous retenez. Vous pouvez tout de même sauvegarder des informations dans l'autre onglet.">
        Liste
    </tab-heading>
    <div class="panel-body panel panel-primary" collapse="context.pair_items.pair_blocks.resources.collapse" ui-on-Drop="onDropResourceToBlock($event,$data,pair_blocks.resources)">
        <accordion close-others="true">
            <accordion-group class="panel panel-success" data-ng-repeat="blockResourceId in pair_blocks.resources track by $index" class="row" data-ng-init="getResourceInfo($parent.$index, blockResourceId.id)">
                <accordion-heading class="panel-heading">
                    <div class="row">
                        <div class="col-xs-2" ng-switch="usedResources[$parent.$parent.$parent.$index][blockResourceId.id].type">
                            <div ng-switch-when="text">
                                <span title="Texte" class="glyphicon glyphicon-font" style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="picture">
                                <img ng-src="{{BASE_CONFIG.urls.images.uploads}}{{usedResources[$parent.$parent.$parent.$index][blockResourceId.id].content.source}}" style="width: 40px; height: 40px;"/>
                            </div>
                            <div ng-switch-when="multiple-choice-question">
                                <span title="QCM" class="glyphicon glyphicon-check" style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="open-ended-question">
                                                                <span class="glyphicon glyphicon-question-sign"
                                                                      title="Question à réponse courte ouverte"
                                                                      style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="sequence">
                                <span class="glyphicon glyphicon-sort-by-order" style="font-size: 260%"></span>
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <h4>{{ getMobilPart(usedResources[$parent.$parent.$parent.$index][blockResourceId.id], pair_blocks.pair_meta_key) }}&nbsp;<span class="caret"></span>
                            </h4>
                        </div>
                        <div class="col-xs-1">

                        </div>
                        <div class="col-xs-1">
                                                                                    <span data-ng-click="$event.stopPropagation();modelRemoveField(pair_blocks.resources, $index)"
                                                                                          class="glyphicon glyphicon-remove"></span>
                        </div>
                    </div>
                </accordion-heading>
                <div class="row">
                    <div class="col-xs-12">
                        <small>ID: {{ usedResources[$parent.$parent.$parent.$index][blockResourceId.id].id }}</small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-4">
                        <small>Auteur: {{ users[usedResources[$parent.$parent.$parent.$index][blockResourceId.id].author] }}</small>
                        <br>
                        <small>Propriétaire: {{ users[usedResources[$parent.$parent.$parent.$index][blockResourceId.id].owner] }}</small>
                    </div>
                    <div class="col-xs-4">
                        <small>Partagé:&nbsp;
                            <ng-switch on="usedResources[$parent.$parent.$parent.$index][blockResourceId.id].public">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                        <br>
                        <small>Archivé:&nbsp;
                            <ng-switch on="usedResources[$parent.$parent.$parent.$index][blockResourceId.id].archived">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                    </div>
                    <div class="col-xs-4">
                        <small>Brouillon:&nbsp;
                            <ng-switch on="usedResources[$parent.$parent.$parent.$index][blockResourceId.id].draft">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                        <br>
                        <small>Complet:&nbsp;
                            <ng-switch on="usedResources[$parent.$parent.$parent.$index][blockResourceId.id].complete">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                    </div>
                </div>
            </accordion-group>
        </accordion>
    </div>
</tab>
<tab>
<tab-heading
    title="Sélectionner les ressources par contraintes. Pensez à cocher la case si c'est le choix que vous retenez. Vous pouvez tout de même sauvegarder des informations dans l'autre onglet.">
    Contraintes
</tab-heading>
<div class="panel-body panel panel-primary" data-ng-init="initResourceConstraints(pair_blocks)">
<div>
    <label>Type de ressource</label><br>

    <div class="btn-group">
        <button title="Texte" class="btn btn-info" ng-model="pair_blocks.resource_constraint.type" btn-radio="'text'">
            <span class="glyphicon glyphicon-font"></span>
        </button>
        <button class="btn btn-info" ng-model="pair_blocks.resource_constraint.type" btn-radio="'picture'"
            title="Image">
            <span class="glyphicon glyphicon-picture"></span>
        </button>
    </div>
</div>
<br/>

<div>
    <label>Liste des containtes</label><br>

    <div class="panel-group">
        <div class="panel panel-info" data-ng-repeat="metadata_constraint in pair_blocks.resource_constraint.metadata_constraints track by $index">
            <div class="panel-heading">
                <ng-switch on="metadata_constraint.comparator">
                    <div ng-switch-when="exists" class="row">
                        <div class="col-xs-10">
                            <h5>Teste l'existence de la clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                    </div>
                    <div ng-switch-when="between" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>Indiquez une valeur inférieure à la valeur de la clé</h5>
                            <input type="text" ng-model="metadata_constraint.values[0]" class="form-control" placeholder="borne inférieur">
                            <h5>Indiquez une valeur supérieure à la valeur de la clé</h5>
                            <input type="text" ng-model="metadata_constraint.values[1]" class="form-control" placeholder="borne supérieur">
                        </div>
                    </div>
                    <div ng-switch-when="in" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>La valeur de la clé doit correspondre à l'une des valeurs indiquées ici</h5>
                        </div>
                        <div data-ng-repeat="value in metadata_constraint.values track by $index">
                            <div class="col-xs-5">
                                <input type="text" ng-model="value" class="form-control" placeholder="valeur">
                            </div>
                            <div class="col-xs-1">
                                                                                                                <span data-ng-click="modelRemoveField(metadata_constraint.values, $index)"
                                                                                                                      class="glyphicon glyphicon-remove"></span>
                            </div>
                        </div>
                        <div>
                            <div class="col-xs-5">
                                <input type="text" id="constrainsInValue" value="" class="form-control" placeholder="nouvelle valeur">
                            </div>
                            <div class="col-xs-1">
                                                                                                                <span data-ng-click="modelAddBlockResourceConstraintValue(metadata_constraint.values)"
                                                                                                                      class="glyphicon glyphicon-plus"></span>
                            </div>
                        </div>
                    </div>
                    <div ng-switch-when="gt" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>La valeur de la clé doit être supérieure à la valeur indiquée ici</h5>
                            <input type="text" ng-model="metadata_constraint.values[0]" class="form-control" placeholder="borne inférieur">
                        </div>
                    </div>
                    <div ng-switch-when="gte" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>La valeur de la clé doit être supérieure ou égale à la valeur indiquée ici</h5>
                            <input type="text" ng-model="metadata_constraint.values[0]" class="form-control" placeholder="borne inférieur">
                        </div>
                    </div>
                    <div ng-switch-when="lt" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>La valeur de la clé doit être inférieure à la valeur indiquée ici</h5>
                            <input type="text" ng-model="metadata_constraint.values[0]" class="form-control" placeholder="borne supérieur">
                        </div>
                    </div>
                    <div ng-switch-when="lte" class="row">
                        <div class="col-xs-10">
                            <h5>Indiquez une clé de métadonnées</h5>
                            <input type="text" ng-model="metadata_constraint.key" class="form-control" placeholder="Clé" ui-on-Drop="onDropMetadataKey($event,$data,metadata_constraint,'key')">
                        </div>
                        <div class="col-xs-2">
                                                                                                            <span data-ng-click="modelRemoveField(pair_blocks.resource_constraint.metadata_constraints, $index)"
                                                                                                                  class="glyphicon glyphicon-remove col-centered pull-right"></span>
                        </div>
                        <div class="col-xs-12">
                            <h5>La valeur de la clé doit être inférieure ou égale à la valeur indiquée ici</h5>
                            <input type="text" ng-model="metadata_constraint.values[0]" class="form-control" placeholder="borne supérieur">
                        </div>
                    </div>
                </ng-switch>
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">
                <span class="glyphicon glyphicon-plus"
                    title="Choisissez le type de contrainte à ajouter"></span>&nbsp;
                <div class="btn-group">
                    <button class="btn btn-info"
                            title="La clé de métadonnée existe"
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'exists')">
                        &exist;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée prend pour valeur..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'in')">
                        &isin;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée est plus grand que..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'gt')">
                        &gt;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée est plus grand ou égale à..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'gte')">
                        &ge;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée est plus petite que..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'lt')">
                        &lt;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée est plus petite ou égale à..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'lte')">
                        &le;
                    </button>
                    <button class="btn btn-info"
                            title="La métadonnée est comprise entre..."
                            data-ng-click="modelAddBlockResourceConstraint(pair_blocks, 'between')">
                        &lt;..&lt;
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div data-ng-init="excludedResources.push([])">
    <label>Ressources exclues</label>

    <div class="panel-body panel panel-primary" ui-on-Drop="onDropResourceToBlock($event,$data,pair_blocks.resource_constraint.excluded)">
        <accordion close-others="true">
            <accordion-group class="panel panel-success" data-ng-repeat="blockResourceId in pair_blocks.resource_constraint.excluded track by $index" class="row" data-ng-init="getExcludedResourceInfo($parent.$index, blockResourceId.id)">
                <accordion-heading class="panel-heading">
                    <div class="row">
                        <div class="col-xs-2" ng-switch="excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].type">
                            <div ng-switch-when="text">
                                <span title="Texte" class="glyphicon glyphicon-font" style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="picture">
                                <img ng-src="{{BASE_CONFIG.urls.images.uploads}}{{excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].content.source}}" style="width: 40px; height: 40px;"/>
                            </div>
                            <div ng-switch-when="multiple-choice-question">
                                <span title="QCM" class="glyphicon glyphicon-check" style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="open-ended-question">
                                <span class="glyphicon glyphicon-question-sign" title="Question à réponse courte ouverte" style="font-size: 260%"></span>
                            </div>
                            <div ng-switch-when="sequence">
                                <span class="glyphicon glyphicon-sort-by-order" style="font-size: 260%"></span>
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <h4>{{ excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].title }}&nbsp;<span class="caret"></span>
                            </h4>
                        </div>
                        <div class="col-xs-1">

                        </div>
                        <div class="col-xs-1">
                                                                                                <span data-ng-click="$event.stopPropagation();modelRemoveField(pair_blocks.resource_constraint.excluded, $index)"
                                                                                                      class="glyphicon glyphicon-remove"></span>
                        </div>
                    </div>
                </accordion-heading>
                <div class="row">
                    <div class="col-xs-12">
                        <small>ID: {{ excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].id }}</small>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-4">
                        <small>Auteur: {{ users[excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].author] }}</small>
                        <br>
                        <small>Propriétaire: {{ users[excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].owner] }}</small>
                    </div>
                    <div class="col-xs-4">
                        <small>Partagé:&nbsp;
                            <ng-switch on="excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].public">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                        <br/>
                        <small>Archivé:&nbsp;
                            <ng-switch on="excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].archived">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                    </div>
                    <div class="col-xs-4">
                        <small>Brouillon:&nbsp;
                            <ng-switch on="excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].draft">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                        <br/>
                        <small>Complet:&nbsp;
                            <ng-switch on="excludedResources[$parent.$parent.$parent.$index][blockResourceId.id].complete">
                                <span ng-switch-when="true">Oui</span>
                                <span ng-switch-when="false">Non</span>
                            </ng-switch>
                        </small>
                    </div>
                </div>
            </accordion-group>
        </accordion>
    </div>
</div>
</div>
</tab>
</tabset>
<br>
<span data-ng-click="pair_blocks.is_list=!pair_blocks.is_list">
    <span class="glyphicon" ng-class="{'glyphicon-check': pair_blocks.is_list, 'glyphicon-unchecked': !pair_blocks.is_list}"></span>
    Sélection des ressources par liste
</span>

&nbsp;&nbsp;
<span data-ng-click="pair_blocks.is_list=!pair_blocks.is_list">
    <span class="glyphicon" ng-class="{'glyphicon-unchecked': pair_blocks.is_list, 'glyphicon-check': !pair_blocks.is_list}"></span>
Sélection par contraintes
</span>
</accordion-group>

<div class="panel panel-primary">
    <div class="panel-heading" data-ng-click="modelAddBlockField(model.content.pair_blocks)">
        <div class="row">
            <div class="col-xs-1">
                <span class="glyphicon glyphicon-plus"></span>
            </div>
            <div class="col-xs-10"></div>
            <div class="col-xs-1"></div>
        </div>
    </div>
</div>

</accordion>
</div>
</div>

<div class="panel panel-primary">
    <div class="panel-heading">
        Mots-clés
        <div class="row">
            <div ng-repeat="keyword in model.keywords track by $index">
                <div class="col-xs-5">
                    <input type="text" ng-model="keyword" class="form-control" disabled>
                </div>
                <div class="col-xs-1"><span data-ng-click="modelRemoveField(model.keywords, $index)"
                                            class="glyphicon glyphicon-remove"
                                            title="Supprimer ce mot-clé"></span></div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-5"><input id="modelAddKeyword" type="text" value=""
                                         placeholder="nouveau mot-clé" class="form-control"></div>
            <div class="col-xs-1"><span data-ng-click="modelAddKeywordsField(model.keywords)"
                                        class="glyphicon glyphicon-plus"
                                        title="Ajouter ce mot-clé"></span></div>
        </div>
    </div>
</div>

<div class="panel panel-primary">
    <div class="panel-heading">
        Métadonnées
        <div class="row">
            <div ng-repeat="meta in model.metadata track by $index">
                <div class="col-xs-5">
                    <input type="text" ng-model="meta.key" class="form-control" disabled>
                </div>
                <div class="col-xs-6">
                    <input type="text" ng-model="meta.value" class="form-control" disabled>
                </div>
                <div class="col-xs-1"><span data-ng-click="modelRemoveField(model.metadata, $index)"
                                            class="glyphicon glyphicon-remove"
                                            title="Supprimer ce couple de métadonnées"></span></div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-5"><input id="modelAddMetadataKey" type="text" value=""
                                         placeholder="nouvelle clé" class="form-control"></div>
            <div class="col-xs-6"><input id="modelAddMetadataValue" type="text" value=""
                                         placeholder="nouvelle valeur" class="form-control"></div>
            <div class="col-xs-1"><span data-ng-click="modelAddMetadataField(model.metadata)"
                                        class="glyphicon glyphicon-plus"
                                        title="Ajouter ce couple de métadonnées"></span></div>
        </div>
    </div>
</div>

<div class="navbar">
    <button back-Button class="btn btn-primary"
            title="Retour à l'écran précédent. Toute modification non sauvegardée sera perdue.">Retour</button>
    <button ng-if="BASE_CONFIG.currentUserId == model.owner"
            ng-click="updateModel()" class="btn btn-primary"
            title="Sauvegarder les modifications. Ne peut pas être annulé.">
        Sauvegarder
    </button>
    <button ng-if="BASE_CONFIG.currentUserId == model.owner"
            ng-disabled="!model.complete"
            ng-click="saveAndTry(model)" class="btn btn-primary"
            title="Sauvegarder puis essayer le modèle">
        Essayer
    </button>
    <button ng-if="BASE_CONFIG.currentUserId != model.owner"
            ng-disabled="!model.complete"
            ng-click="tryModel(model)" class="btn btn-primary"
            title="Essayer le modèle">
        Essayer
    </button>
    <button ng-if="BASE_CONFIG.currentUserId == model.owner"
            ng-click="deleteModel(model)" back-Button
            class="btn btn-danger pull-right"
            title="Supprimer ce modèle. Possible uniquement si aucun exercise n'a été généré à partir de ce modèle">
        Supprimer
    </button>
</div>

</div>
</div>

<script>
    $(function () {
        var window_height = $(window).height(),
            content_height = window_height - 190; // 484

        $('.scrollContainer').height(content_height);
    });

    $(window).resize(function () {
        var window_height = $(window).height(),
            content_height = window_height - 190;
        $('.scrollContainer').height(content_height);
    });
</script>

<div class="scrollContainer"
     ng-class="{'col-xs-7': !$parent.toggleResourceList, 'hide': $parent.toggleResourceList}">
    <div ui-view>
        <div data-ng-include="BASE_CONFIG.urls.partials.teacher+'/partial-resource-list.html'"></div>
    </div>
</div>

</div>
</div>
